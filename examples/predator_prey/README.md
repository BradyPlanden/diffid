# Predator-Prey Parameter Identification Examples

This directory showcases how to recover the parameters of the Lotka–Volterra
predator-prey model using Diffid with several ODE solver backends. All
examples share a synthetic dataset so that the optimisation results can be
compared side by side.

## Contents

- `generate_data_diffrax.py` – creates the shared noisy dataset using JAX and
  Diffrax.
- `predator_prey_diffrax.py` – fits the model using the JAX/Diffrax simulator.
- `predator_prey_diffeqpy.py` – fits the model using the Julia
  DifferentialEquations.jl stack via diffeqpy.
- `predator_prey_diffsol.py` – fits the model using Diffid's Diffsol backend.
- `synthetic_data.npz` – cached dataset generated by the script above
  (re-created on demand).

## Prerequisites

1. A working Python environment (3.11+ recommended). The repository uses
   [uv](https://github.com/astral-sh/uv) but any environment manager works.
2. Install the required packages for the backend you want to try:

   ```bash
   # Base requirements for all examples
   pip install diffid numpy

   # Diffrax example
   pip install jax diffrax

   # Diffeqpy example (also installs Julia bindings)
   pip install diffeqpy
   python -c "from diffeqpy import de; de.install()"  # one-time Julia setup
   ```

   The Diffsol example only needs the base requirements because the solver is
   provided by Diffid.

## Generating the dataset

All optimisation scripts expect a `synthetic_data.npz` file in this directory.
Create it once with:

```bash
python generate_data_diffrax.py
```

Each optimisation script will regenerate the dataset automatically if it is
missing, so running this step manually is optional.

## Running the examples

Run the scripts from this directory (or pass the full path from the repo root):

```bash
python predator_prey_diffrax.py
python predator_prey_diffeqpy.py
python predator_prey_diffsol.py
```

Each script prints the recovered parameters and basic optimisation diagnostics.
Because they all use the same dataset you can directly compare accuracy and
performance across solver backends.

## Troubleshooting

- JAX/Diffrax: enable 64-bit mode is handled inside the scripts. Ensure your
  platform has compatible JAX wheels.
- Diffeqpy: the `de.install()` command downloads a Julia runtime if one is not
  already configured. This can take a few minutes.
- Diffsol: Diffid bundles the solver; no extra setup is required beyond the
  base dependencies.

## Further reading

Check the top-level project README for more background on Diffid and links to
additional examples.